### 流程控制

* 流程控制是每种编程语言控制逻辑走向和执行次序的重要部分，流程控制可以说是一门语言的“经脉”
* Go 语言的常用流程控制有 if 和 for，而 switch 和 goto 主要是为了简化代码、降低重复代码而生的结构，属于扩展类的流程控制。
* 本章主要介绍了 Go 语言中的基本流程控制语句，包括分支语句（if 和 switch）、循环（for）和跳转（goto）语句。另外，还有循环控制语句（break 和 continue），前者的功能是中断循环或者跳出 switch 判断，后者的功能是继续 for 的下一个循环

#### if else（分支结构）
* 在Go语言中，关键字 if 是用于测试某个条件（布尔型或逻辑型）的语句，如果该条件成立，则会执行 if 后由大括号{}括起来的代码块，否则就忽略该代码块继续执行后续的代码
```
if condition {
    // do something
}
```
* 如果存在第二个分支，则可以在上面代码的基础上添加 else 关键字以及另一代码块，这个代码块中的代码只有在条件不满足时才会执行，if 和 else 后的两个代码块是相互独立的分支，只能执行其中一个
```
if condition {
    // do something
} else {
    // do something
}
```
* 如果存在第三个分支，则可以使用下面这种三个独立分支的形式
```
if condition1 {
    // do something
} else if condition2 {
    // do something else
}else {
    // catch-all or default
}
```
* else if 分支的数量是没有限制的，但是为了代码的可读性，还是不要在 if 后面加入太多的 else if 结构，如果必须使用这种形式，则尽可能把先满足的条件放在前面
* 关键字 if 和 else 之后的左大括号{必须和关键字在同一行，如果你使用了 else if 结构，则前段代码块的右大括号 } 必须和 else if 关键字在同一行，这两条规则都是被编译器强制规定的
* 非法的 Go 代码
```
if x{
}
else { // 无效的
}
```
* 要注意的是，在使用 gofmt 格式化代码之后，每个分支内的代码都会缩进 4 个或 8 个空格，或者是 1 个 tab，并且右大括号}与对应的 if 关键字垂直对齐
* 在有些情况下，条件语句两侧的括号是可以被省略的，当条件比较复杂时，则可以使用括号让代码更易读，在使用 &&、|| 或 ! 时可以使用括号来提升某个表达式的运算优先级，并提高代码的可读性

举例
* 通过下面的例子来了解 if 的写法
```
var ten int = 11
if ten > 10 {
    fmt.Println(">10")
} else {
    fmt.Println("<=10")
}
代码输出如下：
>10

代码说明如下：
第 47 行，声明整型变量并赋值 11。
第 48 行，判断当 ten 的值大于 10 时执行第 49 行，否则执行第 51 行。
第 49 和第 51 行，分别打印大于 10 和小于等于 10 时的输出
```

特殊写法
* if 还有一种特殊的写法，可以在 if 表达式之前添加一个执行语句，再根据变量值进行判断，代码如下
```
if err := Connect(); err != nil {
    fmt.Println(err)
    return
}
```
* Connect 是一个带有返回值的函数，err:=Connect() 是一个语句，执行 Connect 后，将错误保存到 err 变量中
* err != nil 才是 if 的判断表达式，当 err 不为空时，打印错误并返回
* 这种写法可以将返回值与判断放在一行进行处理，而且返回值的作用范围被限制在 if、else 语句组合中

提示

* 在编程中，变量的作用范围越小，所造成的问题可能性越小，每一个变量代表一个状态，有状态的地方，状态就会被修改，函数的局部变量只会影响一个函数的执行，但全局变量可能会影响所有代码的执行状态，因此限制变量的作用范围对代码的稳定性有很大的帮助

#### for（循环结构）
* 与多数语言不同的是，Go语言中的循环语句只支持 for 关键字，而不支持 while 和 do-while 结构，关键字 for 的基本使用方法与C语言和 C++ 中非常接近
```
sum := 0
for i := 0; i < 10; i++ {
    sum += i
}
```
* 可以看到比较大的一个不同在于 for 后面的条件表达式不需要用圆括号 () 括起来，Go语言还进一步考虑到无限循环的场景，让开发者不用写无聊的 for(;;){}和do{} while(1);，而直接简化为如下的写法
```
sum := 0
for {
    sum++
    if sum > 100 {
        break
    }
}
```
> 使用循环语句时，需要注意的有以下几点
> * 左花括号{必须与 for 处于同一行
> * Go语言中的 for 循环与C语言一样，都允许在循环条件中定义和初始化变量，唯一的区别是，Go语言不支持以逗号为间隔的多个赋值语句，必须使用平行赋值的方式来初始化多个变量
> * Go语言的 for 循环同样支持 continue 和 break 来控制循环，但是它提供了一个更高级的 break，可以选择中断哪一个循环，如下例
```
for j := 0; j < 5; j++ {
    for i := 0; i < 10; i++ {
        if i > 5 {
            break JLoop
        }
        fmt.Println(i)
    }
}
JLoop:
// ...
```
* 上述代码中，break 语句终止的是 JLoop 标签处的外层循环

#### for 中的初始语句——开始循环时执行的语句
* 初始语句是在第一次循环前执行的语句，一般使用初始语句执行变量初始化，如果变量在此处被声明，其作用域将被局限在这个 for 的范围内
* 初始语句可以被忽略，但是初始语句之后的分号必须要写，代码如下
```
step := 2
for ; step > 0; step-- {
    fmt.Println(step)
}
```
* 这段代码将 step 放在 for 的前面进行初始化，for 中没有初始语句，此时 step 的作用域就比在初始语句中声明 step 要大。

#### for 中的条件表达式——控制是否循环的开关
* 初始语句是在第一次循环前执行的语句，一般使用初始语句执行变量初始化，如果变量在此处被声明，其作用域将被局限在这个 for 的范围内
> 1) 结束循环时带可执行语句的无限循环
* 下面代码忽略条件表达式，但是保留结束语句，代码如下
```
var i int

for ; ; i++ {

    if i > 10 {
        break
    }
}

代码说明如下：
第 132 行，无须设置 i 的初始值，因此忽略 for 的初始语句，两个分号之间是条件表达式，也被忽略，此时循环会一直持续下去，for 的结束语句为 i++，每次结束循环前都会调用。
第 134 行，判断 i 大于 10 时，通过 break 语句跳出 for 循环到第 138 行。
```
> 2) 无限循环
* 上面的代码还可以改写为更美观的写法，代码如下
```
var i int

for {

    if i > 10 {
        break
    }

    i++
}

代码说明如下：
第 148 行，忽略 for 的所有语句，此时 for 执行无限循环。
第 154 行，将 i++ 从 for 的结束语句放置到函数体的末尾是等效的，这样编写的代码更具有可读性。
```
无限循环在收发处理中较为常见，但需要无限循环有可控的退出方式来结束循环

> 3) 只有一个循环条件的循环
* 在上面代码的基础上进一步简化代码，将 if 判断整合到 for 中，变为下面的代码
```
var i int

for i <= 10 {
    i++
}
在代码第 168 行中，将之前使用 if i>10{} 判断的表达式进行取反，变为判断 i 小于等于 10 时持续进行循环
```

上面这段代码其实类似于其他编程语言中的 while，在 while 后添加一个条件表达式，满足条件表达式时持续循环，否则结束循环

#### for 中的结束语句——每次循环结束时执行的语句
* 在结束每次循环前执行的语句，如果循环被 break、goto、return、panic 等语句强制退出，结束语句不会被执行

































